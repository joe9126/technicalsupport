(function(u){function d(r,t){if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveStart("character",r),i.moveEnd("character",t-r),i.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(r,t))}function F(r){var t=this.value.length;if(r=r.toLowerCase()=="start"?"Start":"End",document.selection){var i=document.selection.createRange(),l,v,c;return l=i.duplicate(),l.expand("textedit"),l.setEndPoint("EndToEnd",i),v=l.text.length-i.text.length,c=v+i.text.length,r=="Start"?v:c}else typeof this["selection"+r]<"u"&&(t=this["selection"+r]);return t}var w={codes:{188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};u.fn.number=function(r,t,i,l){l=typeof l>"u"?",":l,i=typeof i>"u"?".":i,t=typeof t>"u"?0:t;var v="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4),c=new RegExp("[^"+v+"0-9]","g"),p=new RegExp(v,"g");return r===!0?this.is("input:text")?this.on({"keydown.format":function(e){var s=u(this),a=s.data("numFormat"),n=e.keyCode?e.keyCode:e.which,f="",h=F.apply(this,["start"]),x=F.apply(this,["end"]),y="",g=!1;if(w.codes.hasOwnProperty(n)&&(n=w.codes[n]),!e.shiftKey&&n>=65&&n<=90?n+=32:!e.shiftKey&&n>=69&&n<=105?n-=48:e.shiftKey&&w.shifts.hasOwnProperty(n)&&(f=w.shifts[n]),f==""&&(f=String.fromCharCode(n)),n!==8&&f!=i&&!f.match(/[0-9]/)){var o=e.keyCode?e.keyCode:e.which;return o==46||o==8||o==9||o==27||o==13||(o==65||o==82)&&(e.ctrlKey||e.metaKey)===!0||(o==86||o==67)&&(e.ctrlKey||e.metaKey)===!0||o>=35&&o<=39?void 0:(e.preventDefault(),!1)}if(h==0&&x==this.value.length||s.val()==0?n===8?(h=x=1,this.value="",a.init=t>0?-1:0,a.c=t>0?-(t+1):0,d.apply(this,[0,0])):f===i?(h=x=1,this.value="0"+i+new Array(t+1).join("0"),a.init=t>0?1:0,a.c=t>0?-(t+1):0):this.value.length===0&&(a.init=t>0?-1:0,a.c=t>0?-t:0):a.c=x-this.value.length,t>0&&f==i&&h==this.value.length-t-1)a.c++,a.init=Math.max(0,a.init),e.preventDefault(),g=this.value.length+a.c;else if(f==i)a.init=Math.max(0,a.init),e.preventDefault();else if(t>0&&n==8&&h==this.value.length-t)e.preventDefault(),a.c--,g=this.value.length+a.c;else if(t>0&&n==8&&h>this.value.length-t){if(this.value==="")return;this.value.slice(h-1,h)!="0"&&(y=this.value.slice(0,h-1)+"0"+this.value.slice(h),s.val(y.replace(c,"").replace(p,i))),e.preventDefault(),a.c--,g=this.value.length+a.c}else n==8&&this.value.slice(h-1,h)==l?(e.preventDefault(),a.c--,g=this.value.length+a.c):t>0&&h==x&&this.value.length>t+1&&h>this.value.length-t-1&&isFinite(+f)&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&f.length===1&&(x===this.value.length?y=this.value.slice(0,h-1):y=this.value.slice(0,h)+this.value.slice(h+1),this.value=y,g=h);g!==!1&&d.apply(this,[g,g]),s.data("numFormat",a)},"keyup.format":function(e){var s=u(this),a=s.data("numFormat"),n=e.keyCode?e.keyCode:e.which,f=F.apply(this,["start"]),h;this.value===""||(n<48||n>57)&&(n<96||n>105)&&n!==8||(s.val(s.val()),t>0&&(a.init<1?(f=this.value.length-t-(a.init<0?1:0),a.c=f-this.value.length,a.init=1,s.data("numFormat",a)):f>this.value.length-t&&n!=8&&(a.c++,s.data("numFormat",a))),h=this.value.length+a.c,d.apply(this,[h,h]))},"paste.format":function(e){var s=u(this),a=e.originalEvent,n=null;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(n=a.clipboardData.getData("text/plain")),s.val(n),e.preventDefault(),!1}}).each(function(){var e=u(this).data("numFormat",{c:-(t+1),decimals:t,thousands_sep:l,dec_point:i,regex_dec_num:c,regex_dec:p,init:!1});this.value!==""&&e.val(e.val())}):this.each(function(){var e=u(this),s=+e.text().replace(c,"").replace(p,".");e.number(isFinite(s)?+s:0,t,i,l)}):this.text(u.number.apply(window,arguments))};var D=null,C=null;u.isPlainObject(u.valHooks.text)?(u.isFunction(u.valHooks.text.get)&&(D=u.valHooks.text.get),u.isFunction(u.valHooks.text.set)&&(C=u.valHooks.text.set)):u.valHooks.text={},u.valHooks.text.get=function(r){var t=u(r),i,l=t.data("numFormat");return l?r.value===""?"":(i=+r.value.replace(l.regex_dec_num,"").replace(l.regex_dec,"."),""+(isFinite(i)?i:0)):u.isFunction(D)?D(r):void 0},u.valHooks.text.set=function(r,t){var i=u(r),l=i.data("numFormat");return l?r.value=u.number(t,l.decimals,l.dec_point,l.thousands_sep):u.isFunction(C)?C(r,t):void 0},u.number=function(r,t,i,l){l=typeof l>"u"?",":l,i=typeof i>"u"?".":i,t=isFinite(+t)?Math.abs(t):0;var v="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4),c="\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4);r=(r+"").replace(".",i).replace(new RegExp(c,"g"),"").replace(new RegExp(v,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var p=isFinite(+r)?+r:0,e="",s=function(a,n){var f=Math.pow(10,n);return""+Math.round(a*f)/f};return e=(t?s(p,t):""+Math.round(p)).split("."),e[0].length>3&&(e[0]=e[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),(e[1]||"").length<t&&(e[1]=e[1]||"",e[1]+=new Array(t-e[1].length+1).join("0")),e.join(i)}})(jQuery);
